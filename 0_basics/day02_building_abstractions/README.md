# 🦀 Day 2 — Building Abstractions in Rust

> **Generics • Traits • Dispatch • Error Handling**

🎯 **Цель:**  
Научиться создавать абстракции в Rust с помощью generics, traits, диспетчинга и безопасной обработки ошибок.  
Ты узнаешь, как проектировать универсальные функции, интерфейсы поведения и контролировать ошибки без исключений.

---

## Generics — Обобщённые функции и структуры

Generics позволяют писать единый код, который работает с разными типами без дублирования.  
Благодаря мономорфизации, Rust подставляет конкретные типы на этапе компиляции, без затрат на производительность.

📂 **Файл:** [`examples/01_generics.rs`](examples/01_generics.rs)  
В этом примере реализуется функция `largest<T>()`, которая ищет максимум в коллекции любых элементов, реализующих
`PartialOrd + Copy`.

---

## Traits — Контракты поведения типов

Traits описывают, *что умеет делать тип*.  
Это интерфейсы без наследования, но с возможностью реализовывать методы по умолчанию и комбинировать поведение.

📂 **Файл:** [`examples/02_traits.rs`](examples/02_traits.rs)  
Пример демонстрирует трейт `Summary` и его реализацию для разных структур.  
Ты увидишь, как через трейты задаётся поведение, общее для множества типов.

---

## Static vs Dynamic Dispatch — Полиморфизм без наследования

Rust реализует два способа вызова методов трейта:

- **Static dispatch** — выбор реализации происходит во время компиляции (`impl Trait` / `<T: Trait>`).  
  Максимальная скорость, но тип фиксирован.
- **Dynamic dispatch** — выбор реализации во время выполнения (`dyn Trait`).  
  Гибкость, возможность хранить разные типы в одной коллекции.

📂 **Файл:** [`examples/03_dispatch.rs`](examples/03_dispatch.rs)  
Пример “Zoo of Polymorphism” — зоопарк, где `Dog` и `Cat` реализуют трейт `Animal`.  
Показывает разницу между `Vec<Dog>` (static) и `Vec<Box<dyn Animal>>` (dynamic).

---

## Error Handling — Работа с Result и Option

Rust не использует исключения.  
Вместо этого применяется `Result<T, E>` для ошибок и `Option<T>` для отсутствующих значений.

📂 **Файл:** [`examples/04_result_option.rs`](examples/04_result_option.rs)

Ты научишься:

- читать файл с помощью `Result` и оператора `?`,
- безопасно работать с делением на ноль через `Option`.  
  Эти механизмы позволяют писать надёжный код без `try/catch`.

---

## Мини-проект — Логгер с трейтами

Практическое задание дня: реализовать логгер, который пишет сообщения в консоль и в файл.  
Поведение описывается через трейт `Logger`, а конкретные реализации — `ConsoleLogger` и `FileLogger`.

📂 **Файл:** [`examples/05_logger_project.rs`](examples/05_logger_project.rs)

Основные цели:

- показать динамический диспетчинг через `&dyn Logger`;
- применить трейты для инкапсуляции поведения;
- закрепить RAII и работу с файловыми ресурсами.

---

## Краткая памятка

| Концепт              | Что делает                           | Пример применения |
|----------------------|--------------------------------------|-------------------|
| **Generics**         | Универсальные функции и структуры    | `fn foo<T>(x: T)` |
| **Traits**           | Контракты поведения типов            | `trait Summary`   |
| **Static Dispatch**  | Выбор реализации во время компиляции | `impl Trait`      |
| **Dynamic Dispatch** | Выбор реализации во время выполнения | `dyn Trait`       |
| **Result / Option**  | Безопасная обработка ошибок          | `?`, `match`      |
| **RAII**             | Автоматическое освобождение ресурсов | `impl Drop`       |

---

## Mind Map — Полиморфизм в Rust

          ┌───────────────────────────┐
          │        Polymorphism       │
          └───────────────────────────┘
                     │
     ┌───────────────┴────────────────┐
     ▼                                ▼
    ┌─────────────┐                  ┌────────────────┐
    │  Generics   │                  │   Traits       │
    └─────────────┘                  └────────────────┘
    │                                │
    ▼                                ▼
    ┌──────────────┐                 ┌────────────────┐
    │ Static Dispatch│              │ Dynamic Dispatch│
    └──────────────┘                 └────────────────┘

## Итог Дня 2

- Generics → позволяют писать универсальный код без дублирования.
- Traits → дают интерфейсы поведения без наследования.
- Static / Dynamic dispatch → обеспечивают полиморфизм на уровне компиляции и выполнения.
- Result / Option → делают ошибки управляемыми и безопасными.
- RAII и Drop → освобождают ресурсы автоматически, без GC.

---

🦀 *“Абстракции Rust — это мощь C++ с безопасностью Haskell.”*